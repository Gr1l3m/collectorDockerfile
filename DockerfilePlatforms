FROM nvcr.io/nvidia/l4t-base:r32.4.4

# Steps for Ubuntu:
#    Install nvidia-container-runtime:
#    sudo apt-get install nvidia-container-runtime
#    Edit/create the /etc/docker/daemon.json with content:
#{
#    "runtimes": {
#        "nvidia": {
#            "path": "/usr/bin/nvidia-container-runtime",
#            "runtimeArgs": []
#         }
#    },
#    "default-runtime": "nvidia"
#}
#    Restart docker daemon:
#    sudo systemctl restart docker
#    Build your image (now GPU available during build):
#    docker build -t my_image_name:latest .


RUN apt-get update && apt-get install -y \
    python3-dev python3-pip git build-essential \
    && python3 -m pip install -U pip \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /

# RUN wget https://raw.githubusercontent.com/jkjung-avt/jetson_nano/master/install_protobuf-3.8.0.sh

COPY install_protobuf-3.8.0.sh install_protobuf-3.8.0.sh

RUN chmod +x install_protobuf-3.8.0.sh && ./install_protobuf-3.8.0.sh

RUN git clone https://github.com/jkjung-avt/tensorrt_demos

WORKDIR /tensorrt_demos/ssd

RUN ./install_pycuda.sh && python -m pip install onnx==1.4.1

WORKDIR /tensorrt_demos/plugins

RUN make -j8
